{"ast":null,"code":"/* jshint node: true */\n\"use strict\";\n\nfunction makeArrayFrom(obj) {\n  return Array.prototype.slice.apply(obj);\n}\n\nvar PENDING = \"pending\",\n    RESOLVED = \"resolved\",\n    REJECTED = \"rejected\";\n\nfunction SynchronousPromise(handler) {\n  this.status = PENDING;\n  this._continuations = [];\n  this._parent = null;\n  this._paused = false;\n\n  if (handler) {\n    handler.call(this, this._continueWith.bind(this), this._failWith.bind(this));\n  }\n}\n\nfunction looksLikeAPromise(obj) {\n  return obj && typeof obj.then === \"function\";\n}\n\nSynchronousPromise.prototype = {\n  then: function (nextFn, catchFn) {\n    var next = SynchronousPromise.unresolved()._setParent(this);\n\n    if (this._isRejected()) {\n      if (this._paused) {\n        this._continuations.push({\n          promise: next,\n          nextFn: nextFn,\n          catchFn: catchFn\n        });\n\n        return next;\n      }\n\n      if (catchFn) {\n        try {\n          var catchResult = catchFn(this._error);\n\n          if (looksLikeAPromise(catchResult)) {\n            this._chainPromiseData(catchResult, next);\n\n            return next;\n          } else {\n            return SynchronousPromise.resolve(catchResult)._setParent(this);\n          }\n        } catch (e) {\n          return SynchronousPromise.reject(e)._setParent(this);\n        }\n      }\n\n      return SynchronousPromise.reject(this._error)._setParent(this);\n    }\n\n    this._continuations.push({\n      promise: next,\n      nextFn: nextFn,\n      catchFn: catchFn\n    });\n\n    this._runResolutions();\n\n    return next;\n  },\n  catch: function (handler) {\n    if (this._isResolved()) {\n      return SynchronousPromise.resolve(this._data)._setParent(this);\n    }\n\n    var next = SynchronousPromise.unresolved()._setParent(this);\n\n    this._continuations.push({\n      promise: next,\n      catchFn: handler\n    });\n\n    this._runRejections();\n\n    return next;\n  },\n  finally: function (callback) {\n    return this._finally = SynchronousPromise.resolve()._setParent(this).then(function () {\n      return callback();\n    });\n  },\n  pause: function () {\n    this._paused = true;\n    return this;\n  },\n  resume: function () {\n    var firstPaused = this._findFirstPaused();\n\n    if (firstPaused) {\n      firstPaused._paused = false;\n\n      firstPaused._runResolutions();\n\n      firstPaused._runRejections();\n    }\n\n    return this;\n  },\n  _findAncestry: function () {\n    return this._continuations.reduce(function (acc, cur) {\n      if (cur.promise) {\n        var node = {\n          promise: cur.promise,\n          children: cur.promise._findAncestry()\n        };\n        acc.push(node);\n      }\n\n      return acc;\n    }, []);\n  },\n  _setParent: function (parent) {\n    if (this._parent) {\n      throw new Error(\"parent already set\");\n    }\n\n    this._parent = parent;\n    return this;\n  },\n  _continueWith: function (data) {\n    var firstPending = this._findFirstPending();\n\n    if (firstPending) {\n      firstPending._data = data;\n\n      firstPending._setResolved();\n    }\n  },\n  _findFirstPending: function () {\n    return this._findFirstAncestor(function (test) {\n      return test._isPending && test._isPending();\n    });\n  },\n  _findFirstPaused: function () {\n    return this._findFirstAncestor(function (test) {\n      return test._paused;\n    });\n  },\n  _findFirstAncestor: function (matching) {\n    var test = this;\n    var result;\n\n    while (test) {\n      if (matching(test)) {\n        result = test;\n      }\n\n      test = test._parent;\n    }\n\n    return result;\n  },\n  _failWith: function (error) {\n    var firstRejected = this._findFirstPending();\n\n    if (firstRejected) {\n      firstRejected._error = error;\n\n      firstRejected._setRejected();\n    }\n  },\n  _takeContinuations: function () {\n    return this._continuations.splice(0, this._continuations.length);\n  },\n  _runRejections: function () {\n    if (this._paused || !this._isRejected()) {\n      return;\n    }\n\n    var error = this._error,\n        continuations = this._takeContinuations(),\n        self = this;\n\n    continuations.forEach(function (cont) {\n      if (cont.catchFn) {\n        try {\n          var catchResult = cont.catchFn(error);\n\n          self._handleUserFunctionResult(catchResult, cont.promise);\n        } catch (e) {\n          var message = e.message;\n          cont.promise.reject(e);\n        }\n      } else {\n        cont.promise.reject(error);\n      }\n    });\n  },\n  _runResolutions: function () {\n    if (this._paused || !this._isResolved()) {\n      return;\n    }\n\n    var continuations = this._takeContinuations();\n\n    if (looksLikeAPromise(this._data)) {\n      return this._handleWhenResolvedDataIsPromise(this._data);\n    }\n\n    var data = this._data;\n    var self = this;\n    continuations.forEach(function (cont) {\n      if (cont.nextFn) {\n        try {\n          var result = cont.nextFn(data);\n\n          self._handleUserFunctionResult(result, cont.promise);\n        } catch (e) {\n          self._handleResolutionError(e, cont);\n        }\n      } else if (cont.promise) {\n        cont.promise.resolve(data);\n      }\n    });\n  },\n  _handleResolutionError: function (e, continuation) {\n    this._setRejected();\n\n    if (continuation.catchFn) {\n      try {\n        continuation.catchFn(e);\n        return;\n      } catch (e2) {\n        e = e2;\n      }\n    }\n\n    if (continuation.promise) {\n      continuation.promise.reject(e);\n    }\n  },\n  _handleWhenResolvedDataIsPromise: function (data) {\n    var self = this;\n    return data.then(function (result) {\n      self._data = result;\n\n      self._runResolutions();\n    }).catch(function (error) {\n      self._error = error;\n\n      self._setRejected();\n\n      self._runRejections();\n    });\n  },\n  _handleUserFunctionResult: function (data, nextSynchronousPromise) {\n    if (looksLikeAPromise(data)) {\n      this._chainPromiseData(data, nextSynchronousPromise);\n    } else {\n      nextSynchronousPromise.resolve(data);\n    }\n  },\n  _chainPromiseData: function (promiseData, nextSynchronousPromise) {\n    promiseData.then(function (newData) {\n      nextSynchronousPromise.resolve(newData);\n    }).catch(function (newError) {\n      nextSynchronousPromise.reject(newError);\n    });\n  },\n  _setResolved: function () {\n    this.status = RESOLVED;\n\n    if (!this._paused) {\n      this._runResolutions();\n    }\n  },\n  _setRejected: function () {\n    this.status = REJECTED;\n\n    if (!this._paused) {\n      this._runRejections();\n    }\n  },\n  _isPending: function () {\n    return this.status === PENDING;\n  },\n  _isResolved: function () {\n    return this.status === RESOLVED;\n  },\n  _isRejected: function () {\n    return this.status === REJECTED;\n  }\n};\n\nSynchronousPromise.resolve = function (result) {\n  return new SynchronousPromise(function (resolve, reject) {\n    if (looksLikeAPromise(result)) {\n      result.then(function (newResult) {\n        resolve(newResult);\n      }).catch(function (error) {\n        reject(error);\n      });\n    } else {\n      resolve(result);\n    }\n  });\n};\n\nSynchronousPromise.reject = function (result) {\n  return new SynchronousPromise(function (resolve, reject) {\n    reject(result);\n  });\n};\n\nSynchronousPromise.unresolved = function () {\n  return new SynchronousPromise(function (resolve, reject) {\n    this.resolve = resolve;\n    this.reject = reject;\n  });\n};\n\nSynchronousPromise.all = function () {\n  var args = makeArrayFrom(arguments);\n\n  if (Array.isArray(args[0])) {\n    args = args[0];\n  }\n\n  if (!args.length) {\n    return SynchronousPromise.resolve([]);\n  }\n\n  return new SynchronousPromise(function (resolve, reject) {\n    var allData = [],\n        numResolved = 0,\n        doResolve = function () {\n      if (numResolved === args.length) {\n        resolve(allData);\n      }\n    },\n        rejected = false,\n        doReject = function (err) {\n      if (rejected) {\n        return;\n      }\n\n      rejected = true;\n      reject(err);\n    };\n\n    args.forEach(function (arg, idx) {\n      SynchronousPromise.resolve(arg).then(function (thisResult) {\n        allData[idx] = thisResult;\n        numResolved += 1;\n        doResolve();\n      }).catch(function (err) {\n        doReject(err);\n      });\n    });\n  });\n};\n/* jshint ignore:start */\n\n\nif (Promise === SynchronousPromise) {\n  throw new Error(\"Please use SynchronousPromise.installGlobally() to install globally\");\n}\n\nvar RealPromise = Promise;\n\nSynchronousPromise.installGlobally = function (__awaiter) {\n  if (Promise === SynchronousPromise) {\n    return __awaiter;\n  }\n\n  var result = patchAwaiterIfRequired(__awaiter);\n  Promise = SynchronousPromise;\n  return result;\n};\n\nSynchronousPromise.uninstallGlobally = function () {\n  if (Promise === SynchronousPromise) {\n    Promise = RealPromise;\n  }\n};\n\nfunction patchAwaiterIfRequired(__awaiter) {\n  if (typeof __awaiter === \"undefined\" || __awaiter.__patched) {\n    return __awaiter;\n  }\n\n  var originalAwaiter = __awaiter;\n\n  __awaiter = function () {\n    var Promise = RealPromise;\n    originalAwaiter.apply(this, makeArrayFrom(arguments));\n  };\n\n  __awaiter.__patched = true;\n  return __awaiter;\n}\n/* jshint ignore:end */\n\n\nmodule.exports = {\n  SynchronousPromise: SynchronousPromise\n};","map":{"version":3,"sources":["/home/sergol/DBprojects/instaz/frontend/node_modules/synchronous-promise/index.js"],"names":["makeArrayFrom","obj","Array","prototype","slice","apply","PENDING","RESOLVED","REJECTED","SynchronousPromise","handler","status","_continuations","_parent","_paused","call","_continueWith","bind","_failWith","looksLikeAPromise","then","nextFn","catchFn","next","unresolved","_setParent","_isRejected","push","promise","catchResult","_error","_chainPromiseData","resolve","e","reject","_runResolutions","catch","_isResolved","_data","_runRejections","finally","callback","_finally","pause","resume","firstPaused","_findFirstPaused","_findAncestry","reduce","acc","cur","node","children","parent","Error","data","firstPending","_findFirstPending","_setResolved","_findFirstAncestor","test","_isPending","matching","result","error","firstRejected","_setRejected","_takeContinuations","splice","length","continuations","self","forEach","cont","_handleUserFunctionResult","message","_handleWhenResolvedDataIsPromise","_handleResolutionError","continuation","e2","nextSynchronousPromise","promiseData","newData","newError","newResult","all","args","arguments","isArray","allData","numResolved","doResolve","rejected","doReject","err","arg","idx","thisResult","Promise","RealPromise","installGlobally","__awaiter","patchAwaiterIfRequired","uninstallGlobally","__patched","originalAwaiter","module","exports"],"mappings":"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","sourcesContent":["/* jshint node: true */\n\"use strict\";\nfunction makeArrayFrom(obj) {\n  return Array.prototype.slice.apply(obj);\n}\nvar\n  PENDING = \"pending\",\n  RESOLVED = \"resolved\",\n  REJECTED = \"rejected\";\n\nfunction SynchronousPromise(handler) {\n  this.status = PENDING;\n  this._continuations = [];\n  this._parent = null;\n  this._paused = false;\n  if (handler) {\n    handler.call(\n      this,\n      this._continueWith.bind(this),\n      this._failWith.bind(this)\n    );\n  }\n}\n\nfunction looksLikeAPromise(obj) {\n  return obj && typeof (obj.then) === \"function\";\n}\n\nSynchronousPromise.prototype = {\n  then: function (nextFn, catchFn) {\n    var next = SynchronousPromise.unresolved()._setParent(this);\n    if (this._isRejected()) {\n      if (this._paused) {\n        this._continuations.push({\n          promise: next,\n          nextFn: nextFn,\n          catchFn: catchFn\n        });\n        return next;\n      }\n      if (catchFn) {\n        try {\n          var catchResult = catchFn(this._error);\n          if (looksLikeAPromise(catchResult)) {\n            this._chainPromiseData(catchResult, next);\n            return next;\n          } else {\n            return SynchronousPromise.resolve(catchResult)._setParent(this);\n          }\n        } catch (e) {\n          return SynchronousPromise.reject(e)._setParent(this);\n        }\n      }\n      return SynchronousPromise.reject(this._error)._setParent(this);\n    }\n    this._continuations.push({\n      promise: next,\n      nextFn: nextFn,\n      catchFn: catchFn\n    });\n    this._runResolutions();\n    return next;\n  },\n  catch: function (handler) {\n    if (this._isResolved()) {\n      return SynchronousPromise.resolve(this._data)._setParent(this);\n    }\n    var next = SynchronousPromise.unresolved()._setParent(this);\n    this._continuations.push({\n      promise: next,\n      catchFn: handler\n    });\n    this._runRejections();\n    return next;\n  },\n  finally: function(callback) {\n    return (this._finally = SynchronousPromise.resolve()\n      ._setParent(this)\n      .then(function() {\n        return callback();\n      }));\n  },\n  pause: function () {\n    this._paused = true;\n    return this;\n  },\n  resume: function () {\n    var firstPaused = this._findFirstPaused();\n    if (firstPaused) {\n      firstPaused._paused = false;\n      firstPaused._runResolutions();\n      firstPaused._runRejections();\n    }\n    return this;\n  },\n  _findAncestry: function () {\n    return this._continuations.reduce(function (acc, cur) {\n      if (cur.promise) {\n        var node = {\n          promise: cur.promise,\n          children: cur.promise._findAncestry()\n        };\n        acc.push(node);\n      }\n      return acc;\n    }, []);\n  },\n  _setParent: function (parent) {\n    if (this._parent) {\n      throw new Error(\"parent already set\");\n    }\n    this._parent = parent;\n    return this;\n  },\n  _continueWith: function (data) {\n    var firstPending = this._findFirstPending();\n    if (firstPending) {\n      firstPending._data = data;\n      firstPending._setResolved();\n    }\n  },\n  _findFirstPending: function () {\n    return this._findFirstAncestor(function (test) {\n      return test._isPending && test._isPending();\n    });\n  },\n  _findFirstPaused: function () {\n    return this._findFirstAncestor(function (test) {\n      return test._paused;\n    });\n  },\n  _findFirstAncestor: function (matching) {\n    var test = this;\n    var result;\n    while (test) {\n      if (matching(test)) {\n        result = test;\n      }\n      test = test._parent;\n    }\n    return result;\n  },\n  _failWith: function (error) {\n    var firstRejected = this._findFirstPending();\n    if (firstRejected) {\n      firstRejected._error = error;\n      firstRejected._setRejected();\n    }\n  },\n  _takeContinuations: function () {\n    return this._continuations.splice(0, this._continuations.length);\n  },\n  _runRejections: function () {\n    if (this._paused || !this._isRejected()) {\n      return;\n    }\n    var\n      error = this._error,\n      continuations = this._takeContinuations(),\n      self = this;\n    continuations.forEach(function (cont) {\n      if (cont.catchFn) {\n        try {\n          var catchResult = cont.catchFn(error);\n          self._handleUserFunctionResult(catchResult, cont.promise);\n        } catch (e) {\n          var message = e.message;\n          cont.promise.reject(e);\n        }\n      } else {\n        cont.promise.reject(error);\n      }\n    });\n  },\n  _runResolutions: function () {\n    if (this._paused || !this._isResolved()) {\n      return;\n    }\n    var continuations = this._takeContinuations();\n    if (looksLikeAPromise(this._data)) {\n      return this._handleWhenResolvedDataIsPromise(this._data);\n    }\n    var data = this._data;\n    var self = this;\n    continuations.forEach(function (cont) {\n      if (cont.nextFn) {\n        try {\n          var result = cont.nextFn(data);\n          self._handleUserFunctionResult(result, cont.promise);\n        } catch (e) {\n          self._handleResolutionError(e, cont);\n        }\n      } else if (cont.promise) {\n        cont.promise.resolve(data);\n      }\n    });\n  },\n  _handleResolutionError: function (e, continuation) {\n    this._setRejected();\n    if (continuation.catchFn) {\n      try {\n        continuation.catchFn(e);\n        return;\n      } catch (e2) {\n        e = e2;\n      }\n    }\n    if (continuation.promise) {\n      continuation.promise.reject(e);\n    }\n  },\n  _handleWhenResolvedDataIsPromise: function (data) {\n    var self = this;\n    return data.then(function (result) {\n      self._data = result;\n      self._runResolutions();\n    }).catch(function (error) {\n      self._error = error;\n      self._setRejected();\n      self._runRejections();\n    });\n  },\n  _handleUserFunctionResult: function (data, nextSynchronousPromise) {\n    if (looksLikeAPromise(data)) {\n      this._chainPromiseData(data, nextSynchronousPromise);\n    } else {\n      nextSynchronousPromise.resolve(data);\n    }\n  },\n  _chainPromiseData: function (promiseData, nextSynchronousPromise) {\n    promiseData.then(function (newData) {\n      nextSynchronousPromise.resolve(newData);\n    }).catch(function (newError) {\n      nextSynchronousPromise.reject(newError);\n    });\n  },\n  _setResolved: function () {\n    this.status = RESOLVED;\n    if (!this._paused) {\n      this._runResolutions();\n    }\n  },\n  _setRejected: function () {\n    this.status = REJECTED;\n    if (!this._paused) {\n      this._runRejections();\n    }\n  },\n  _isPending: function () {\n    return this.status === PENDING;\n  },\n  _isResolved: function () {\n    return this.status === RESOLVED;\n  },\n  _isRejected: function () {\n    return this.status === REJECTED;\n  }\n};\n\nSynchronousPromise.resolve = function (result) {\n  return new SynchronousPromise(function (resolve, reject) {\n    if (looksLikeAPromise(result)) {\n      result.then(function (newResult) {\n        resolve(newResult);\n      }).catch(function (error) {\n        reject(error);\n      });\n    } else {\n      resolve(result);\n    }\n  });\n};\n\nSynchronousPromise.reject = function (result) {\n  return new SynchronousPromise(function (resolve, reject) {\n    reject(result);\n  });\n};\n\nSynchronousPromise.unresolved = function () {\n  return new SynchronousPromise(function (resolve, reject) {\n    this.resolve = resolve;\n    this.reject = reject;\n  });\n};\n\nSynchronousPromise.all = function () {\n  var args = makeArrayFrom(arguments);\n  if (Array.isArray(args[0])) {\n    args = args[0];\n  }\n  if (!args.length) {\n    return SynchronousPromise.resolve([]);\n  }\n  return new SynchronousPromise(function (resolve, reject) {\n    var\n      allData = [],\n      numResolved = 0,\n      doResolve = function () {\n        if (numResolved === args.length) {\n          resolve(allData);\n        }\n      },\n      rejected = false,\n      doReject = function (err) {\n        if (rejected) {\n          return;\n        }\n        rejected = true;\n        reject(err);\n      };\n    args.forEach(function (arg, idx) {\n      SynchronousPromise.resolve(arg).then(function (thisResult) {\n        allData[idx] = thisResult;\n        numResolved += 1;\n        doResolve();\n      }).catch(function (err) {\n        doReject(err);\n      });\n    });\n  });\n};\n\n/* jshint ignore:start */\nif (Promise === SynchronousPromise) {\n  throw new Error(\"Please use SynchronousPromise.installGlobally() to install globally\");\n}\nvar RealPromise = Promise;\nSynchronousPromise.installGlobally = function(__awaiter) {\n  if (Promise === SynchronousPromise) {\n    return __awaiter;\n  }\n  var result = patchAwaiterIfRequired(__awaiter);\n  Promise = SynchronousPromise;\n  return result;\n};\n\nSynchronousPromise.uninstallGlobally = function() {\n  if (Promise === SynchronousPromise) {\n    Promise = RealPromise;\n  }\n};\n\nfunction patchAwaiterIfRequired(__awaiter) {\n  if (typeof(__awaiter) === \"undefined\" || __awaiter.__patched) {\n    return __awaiter;\n  }\n  var originalAwaiter = __awaiter;\n  __awaiter = function() {\n    var Promise = RealPromise;\n    originalAwaiter.apply(this, makeArrayFrom(arguments));\n  };\n  __awaiter.__patched = true;\n  return __awaiter;\n}\n/* jshint ignore:end */\n\nmodule.exports = {\n  SynchronousPromise: SynchronousPromise\n};"]},"metadata":{},"sourceType":"script"}