{"ast":null,"code":"import _objectSpread from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/sergol/DBprojects/instaz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{Link,Redirect}from'react-router-dom';import CommentForm from'./CommentForm';var PostListItem=/*#__PURE__*/function(_React$Component){_inherits(PostListItem,_React$Component);function PostListItem(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostListItem);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostListItem)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={isArchiving:false,redirectToHome:false};return _this;}_createClass(PostListItem,[{key:\"render\",value:function render(){var _this2=this;if(this.state.redirectToHome){return React.createElement(Redirect,{to:\"/\"});}var _this$props=this.props,currentUser=_this$props.currentUser,post=_this$props.post,isPreview=_this$props.isPreview,showActions=_this$props.showActions;var captionPreviewElem=function captionPreviewElem(_ref){var id=_ref.id,caption=_ref.caption;return React.createElement(\"span\",null,caption+'...',\" \",React.createElement(Link,{className:\"ui sub header\",to:\"/p/\".concat(id)},\"View full caption\"));};var postActionsElem=function postActionsElem(user,post){return React.createElement(\"div\",{className:\"content action-icons\"},React.createElement(\"i\",{onClick:function onClick(){return _this2.props.likePost(post.id);},className:\"clickable big heart like icon\"+(post.is_liked?\" red\":\"\")}),React.createElement(\"i\",{onClick:function onClick(){document.getElementById(\"comment-field\".concat(post.id)).focus();},className:\"clickable big comment outline link icon\"}),React.createElement(\"i\",{className:\"clickable big share icon\"}),// Show archive button for post owner\npost.author.username===user.username?React.createElement(\"span\",{className:\"clickable right floated\",\"data-inverted\":\"\",\"data-tooltip\":_this2.state.isArchiving?\"Archiving...\":\"Archive this post\",\"data-position\":\"top center\",onClick:function onClick(){_this2.setState({isArchiving:true});_this2.props.editPost(_objectSpread({},post,{is_active:false})).then(function(){_this2.setState({isArchiving:false,redirectToHome:!isPreview});});}},React.createElement(\"i\",{className:(_this2.state.isArchiving?\"ui loading circle notch\":\"archive icon\")+\" big link icon\"})):null);};return React.createElement(\"div\",{className:\"ui fluid card\"},React.createElement(\"div\",{className:\"content\"},React.createElement(Link,{className:\"ui right floated sub header\",to:\"/p/\".concat(post.id)},post.timesince_posted,\" ago\"),React.createElement(Link,{className:\"ui left floated small header\",to:\"/u/\".concat(post.author.username)},React.createElement(\"img\",{className:\"ui avatar image\",src:post.author.avatar,alt:\"\".concat(post.author.username,\"'s avatar\")}),post.author.username)),React.createElement(\"div\",{className:\"image\"},React.createElement(\"img\",{src:post.image,alt:post.caption})),// Only show action icons for authenticated user\nshowActions?postActionsElem(currentUser,post):null,React.createElement(\"div\",{className:\"relaxed content\"},React.createElement(\"p\",{className:\"ui sub header\"},post.likes,\" likes\"),React.createElement(\"p\",{className:\"post-description\"},React.createElement(Link,{className:\"ui left floated small header author\",to:\"/u/\".concat(post.author.username)},post.author.username),post.caption&&post.caption.length>120&&isPreview?captionPreviewElem(post):post.caption),post.comments.length>0?React.createElement(\"div\",{className:\"ui divider\"}):null,post.comments.map(function(comment,index){// Only show up to 3 comments for posts in list\nreturn isPreview&&index>2?null:React.createElement(\"p\",{key:comment.id},React.createElement(Link,{className:\"ui left floated small header\",to:\"/u/\".concat(comment.author.username)},comment.author.username),comment.message);}),isPreview&&post.comments.length>3?React.createElement(Link,{className:\"ui left floated sub header\",to:\"/p/\".concat(post.id)},\"View all comments\"):null),// Only show comment form for authenticated user\nshowActions?React.createElement(CommentForm,{post:post,addComment:this.props.addComment,elementId:\"comment-field\".concat(post.id)}):null);}}]);return PostListItem;}(React.Component);export default PostListItem;","map":{"version":3,"sources":["/home/sergol/DBprojects/instaz/frontend/src/components/PostListItem.js"],"names":["React","Link","Redirect","CommentForm","PostListItem","state","isArchiving","redirectToHome","props","currentUser","post","isPreview","showActions","captionPreviewElem","id","caption","postActionsElem","user","likePost","is_liked","document","getElementById","focus","author","username","setState","editPost","is_active","then","timesince_posted","avatar","image","likes","length","comments","map","comment","index","message","addComment","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link, Redirect } from 'react-router-dom';\n\nimport CommentForm from './CommentForm';\n\nclass PostListItem extends React.Component {\n  state = {\n    isArchiving: false,\n    redirectToHome: false\n  };\n\n  render() {\n    if (this.state.redirectToHome) {\n      return <Redirect to=\"/\" />;\n    }\n\n    const { currentUser, post, isPreview, showActions } = this.props;\n    const captionPreviewElem = ({ id, caption }) => (\n      <span>\n        {caption + '...'} <Link className=\"ui sub header\" to={`/p/${id}`}>View full caption</Link>\n      </span>\n    );\n    const postActionsElem = (user, post) => (\n      <div className=\"content action-icons\">\n        <i\n          onClick={() => this.props.likePost(post.id)}\n          className={\"clickable big heart like icon\" + (post.is_liked ? \" red\" : \"\")}>\n        </i>\n        <i\n          onClick={() => { document.getElementById(`comment-field${post.id}`).focus(); }}\n          className=\"clickable big comment outline link icon\">\n        </i>\n        <i className=\"clickable big share icon\"></i>\n        {\n          // Show archive button for post owner\n          post.author.username === user.username\n            ? <span\n                className=\"clickable right floated\"\n                data-inverted=\"\"\n                data-tooltip={ this.state.isArchiving ? \"Archiving...\" : \"Archive this post\" }\n                data-position=\"top center\"\n                onClick={() => {\n                  this.setState({ isArchiving: true });\n                  this.props.editPost({ ...post, is_active: false }).then(() => {\n                    this.setState({ isArchiving: false, redirectToHome: !isPreview });\n                  });\n                }}>\n                  <i className={\n                    (this.state.isArchiving\n                     ? \"ui loading circle notch\"\n                     : \"archive icon\") + \" big link icon\"\n                  }></i>\n              </span>\n          : null\n        }\n      </div>\n    );\n\n    return(\n      <div className=\"ui fluid card\">\n        <div className=\"content\">\n          <Link className=\"ui right floated sub header\" to={`/p/${post.id}`}>{post.timesince_posted} ago</Link>\n          <Link className=\"ui left floated small header\" to={`/u/${post.author.username}`}>\n            <img className=\"ui avatar image\" src={post.author.avatar} alt={`${post.author.username}'s avatar`} />\n            {post.author.username}\n          </Link>\n        </div>\n        <div className=\"image\">\n          <img src={post.image} alt={post.caption} />\n        </div>\n        {\n          // Only show action icons for authenticated user\n          showActions ? postActionsElem(currentUser, post) : null\n        }\n        <div className=\"relaxed content\">\n          <p className=\"ui sub header\">{post.likes} likes</p>\n          <p className=\"post-description\">\n            <Link className=\"ui left floated small header author\" to={`/u/${post.author.username}`}>\n              {post.author.username}\n            </Link>\n            {post.caption && post.caption.length > 120 && isPreview ? captionPreviewElem(post) : post.caption}\n          </p>\n          { post.comments.length > 0 ? <div className=\"ui divider\"></div> : null }\n          {\n            post.comments.map((comment, index) => {\n              // Only show up to 3 comments for posts in list\n              return isPreview && index > 2 ? null : (\n                <p key={comment.id}>\n                  <Link className=\"ui left floated small header\" to={`/u/${comment.author.username}`}>\n                    {comment.author.username}\n                  </Link>\n                  {comment.message}\n                </p>\n              )\n            })\n          }\n          {\n            isPreview && post.comments.length > 3\n            ? <Link className=\"ui left floated sub header\" to={`/p/${post.id}`}>View all comments</Link>\n            : null\n          }\n        </div>\n        {\n          // Only show comment form for authenticated user\n          showActions ? (\n            <CommentForm post={post} addComment={this.props.addComment} elementId={`comment-field${post.id}`} />\n          ) : null\n        }\n      </div>\n    );\n  }\n}\n\nexport default PostListItem;\n"]},"metadata":{},"sourceType":"module"}